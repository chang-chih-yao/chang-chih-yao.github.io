<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>龍伴建築試算</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
</head>
<body>
  <button id="High">真龍建築</button>
  <button id="cry">龍泣碑</button>
  <button id="train">訓練場</button>
  <button id="even">活動建築</button>
  <br/>
  <br/>
  <span style="font-size:14px;">目前建築等級：</span>
  <select id=theList></select>
  <table border="1" width="100" id="my_table1"></table> 
  <h3 id="show">Loading...</h3>
</body>
</html>

<script>
  $(function(){
    document.getElementById('High').disabled=true;
    document.getElementById('cry').disabled=true;
    document.getElementById('train').disabled=true;
    document.getElementById('even').disabled=true;
    
    var a = {
      sheetUrl : 'https://docs.google.com/spreadsheets/d/10Zqw0itl0gh0oewy5_I9LamZnICU5exQKCIAazlNBAQ/edit?usp=sharing',
      sheetTag : '真龍建築',
      row: 4,
      col: 3,
      endRow : 33,
      endCol : 7
    };
    var b = {
      sheetUrl : 'https://docs.google.com/spreadsheets/d/10Zqw0itl0gh0oewy5_I9LamZnICU5exQKCIAazlNBAQ/edit?usp=sharing',
      sheetTag : '龍泣碑',
      row: 4,
      col: 3,
      endRow : 23,
      endCol : 7
    };
    var c = {
      sheetUrl : 'https://docs.google.com/spreadsheets/d/10Zqw0itl0gh0oewy5_I9LamZnICU5exQKCIAazlNBAQ/edit?usp=sharing',
      sheetTag : '訓練場',
      row: 4,
      col: 3,
      endRow : 33,
      endCol : 9
    };
    var d = {
      sheetUrl : 'https://docs.google.com/spreadsheets/d/10Zqw0itl0gh0oewy5_I9LamZnICU5exQKCIAazlNBAQ/edit?usp=sharing',
      sheetTag : '活動建築',
      row: 4,
      col: 3,
      endRow : 33,
      endCol : 5
    };
    
    var $show = $('#show');
    var $High = $('#High');
    var $cry = $('#cry');
    var $train = $('#train');
    var $even = $('#even');
    var $show_High = "";
    var $show_cry = "";
    var $show_train = "";
    var $show_even = "";
    var cou = 0;
    
    var my_time = setInterval(my_timer, 100);
    
    function my_timer(){
      if (cou == 4){
        $show.text("Successful");
        document.getElementById('High').disabled=false;
        document.getElementById('cry').disabled=false;
        document.getElementById('train').disabled=false;
        document.getElementById('even').disabled=false;
        clearInterval(my_time);
      }
    }
    
    
    var myArray = [[1,2,3],[4,5,6],[7,8,9]]; 
    var t = document.getElementById("my_table1"); 
    for(var i=0;i<myArray.length;i++) { 
       t.insertRow(); 
       for(var j=0;j<myArray[i].length;j++) { 
          t.rows[i].insertCell(j); 
          t.rows[i].cells[j].innerText = myArray[i][j]; 
       }    
    } 
    

    $.get('https://script.google.com/macros/s/AKfycbwBM9uDumPSVrV57lxTiJWyfjWMCOw4g9bbYtH8CUaMgNbx-vE/exec',a, function(data){
      var my_data = data.split(',');  //把傳出來的字串分割成陣列
      var arr = [];
      for(var i=0; i<(a.endRow-a.row+1); i++){
        arr[i] = my_data.splice(0, (a.endCol-a.col+1)); 
        $show_High += (arr[i]+'<br/>');
      }
      cou += 1;
    });
    
    $.get('https://script.google.com/macros/s/AKfycbwBM9uDumPSVrV57lxTiJWyfjWMCOw4g9bbYtH8CUaMgNbx-vE/exec',b, function(data){
      var my_data = data.split(',');  //把傳出來的字串分割成陣列
      var arr = [];
      for(var i=0; i<(b.endRow-b.row+1); i++){
        arr[i] = my_data.splice(0, (b.endCol-b.col+1)); 
        $show_cry += (arr[i]+'<br/>');
      }
      cou += 1;
    });
    
    $.get('https://script.google.com/macros/s/AKfycbwBM9uDumPSVrV57lxTiJWyfjWMCOw4g9bbYtH8CUaMgNbx-vE/exec',c, function(data){
      var my_data = data.split(',');  //把傳出來的字串分割成陣列
      var arr = [];
      for(var i=0; i<(c.endRow-c.row+1); i++){
        arr[i] = my_data.splice(0, (c.endCol-c.col+1)); 
        $show_train += (arr[i]+'<br/>');
      }
      cou += 1;
    });
    
    $.get('https://script.google.com/macros/s/AKfycbwBM9uDumPSVrV57lxTiJWyfjWMCOw4g9bbYtH8CUaMgNbx-vE/exec',d, function(data){
      var my_data = data.split(',');  //把傳出來的字串分割成陣列
      var arr = [];
      for(var i=0; i<(d.endRow-d.row+1); i++){
        arr[i] = my_data.splice(0, (d.endCol-d.col+1)); 
        $show_even += (arr[i]+'<br/>');
      }
      cou += 1;
    });
    
    
    $High.on('click', function() {
      $show.empty();
      $show.html($show_High);
      var i;
      for(i = theList.options.length - 1 ; i >= 0 ; i--){
        theList.remove(i);
      }
      for(var j = 0; j < (a.endRow - a.row +1); j++){
        var index=theList.options.length;
        theList.options[index]=new Option(j, j);
      }
    });

    $cry.on('click', function() {
      $show.empty();
      $show.html($show_cry);
      var i;
      for(i = theList.options.length - 1 ; i >= 0 ; i--){
        theList.remove(i);
      }
      for(var j = 0; j < (b.endRow - b.row +1); j++){
        var index=theList.options.length;
        theList.options[index]=new Option(j, j);
      }
    });
    
    $train.on('click', function() {
      $show.empty();
      $show.html($show_train);
      var i;
      for(i = theList.options.length - 1 ; i >= 0 ; i--){
        theList.remove(i);
      }
      for(var j = 0; j < (c.endRow - c.row +1); j++){
        var index=theList.options.length;
        theList.options[index]=new Option(j, j);
      }
    });
    
    $even.on('click', function() {
      $show.empty();
      $show.html($show_even);
      var i;
      for(i = theList.options.length - 1 ; i >= 0 ; i--){
        theList.remove(i);
      }
      for(var j = 0; j < (d.endRow - d.row +1); j++){
        var index=theList.options.length;
        theList.options[index]=new Option(j, j);
      }
    });
  });
</script>