<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>龍伴建築素材試算</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <style>
    table, th, td{
      border:2px solid white;
      border-collapse:collapse;
      text-align:center;
      background-color:#DDDDDD
    }
    th{
      background-color:#b300b3;
      color:white;
    }
    hr {
      display: block;
      margin-top: 1em;
      margin-bottom: 1em;
      margin-left: auto;
      margin-right: auto;
      border-style: solid;
      border-width: 2px;
    }
  </style>
</head>
<body>
    <button id="High" style="background-color:#e6e6e6;">真龍建築</button>
    <button id="cry" style="background-color:#e6e6e6;">龍泣碑</button>
    <button id="train" style="background-color:#e6e6e6;">訓練場</button>
    <button id="altar" style="background-color:#e6e6e6;">祭壇</button>
    <button id="even" style="background-color:#e6e6e6;">活動建築</button>
  <br/>
  <br/>
  <h3 id="show">Loading...</h3>
  <h3 id="zzz"></h3>
  <span id="now_lv"></span>
  <select id=theList></select>
  <table border="2" width="400" id="my_table2"></table> 
  <hr>
  <h3 id="button_tag"></h3>
  <table border="2" width="400" id="my_table1"></table> 
</body>
</html>

<script>
  $(function(){
    document.getElementById('theList').style.visibility = "hidden";
    document.getElementById('High').disabled=true;
    document.getElementById('cry').disabled=true;
    document.getElementById('train').disabled=true;
    document.getElementById('altar').disabled=true;
    document.getElementById('even').disabled=true;
    
    var a = {
      sheetUrl : 'https://docs.google.com/spreadsheets/d/10Zqw0itl0gh0oewy5_I9LamZnICU5exQKCIAazlNBAQ/edit?usp=sharing',
      sheetTag : '真龍建築',
      row: 4,
      col: 2,
      endRow : 33,
      endCol : 7
    };
    var b = {
      sheetUrl : 'https://docs.google.com/spreadsheets/d/10Zqw0itl0gh0oewy5_I9LamZnICU5exQKCIAazlNBAQ/edit?usp=sharing',
      sheetTag : '龍泣碑',
      row: 4,
      col: 2,
      endRow : 23,
      endCol : 7
    };
    var c = {
      sheetUrl : 'https://docs.google.com/spreadsheets/d/10Zqw0itl0gh0oewy5_I9LamZnICU5exQKCIAazlNBAQ/edit?usp=sharing',
      sheetTag : '訓練場',
      row: 4,
      col: 2,
      endRow : 38,
      endCol : 9
    };
    var d = {
      sheetUrl : 'https://docs.google.com/spreadsheets/d/10Zqw0itl0gh0oewy5_I9LamZnICU5exQKCIAazlNBAQ/edit?usp=sharing',
      sheetTag : '祭壇',
      row: 4,
      col: 2,
      endRow : 38,
      endCol : 7
    };
    var e = {
      sheetUrl : 'https://docs.google.com/spreadsheets/d/10Zqw0itl0gh0oewy5_I9LamZnICU5exQKCIAazlNBAQ/edit?usp=sharing',
      sheetTag : '活動建築',
      row: 4,
      col: 2,
      endRow : 33,
      endCol : 5
    };
    
    var $button_tag = $('#button_tag');
    var $zzz = $('#zzz');
    var $show = $('#show');
    var $now_lv = $('#now_lv');

    var $High = $('#High');
    var $cry = $('#cry');
    var $train = $('#train');
    var $altar = $('#altar');
    var $even = $('#even');
    var $show_High = "";
    var $show_cry = "";
    var $show_train = "";
    var $show_even = "";
    var img_size = "40px";
    var cou = 0;
    var now_time = new Date();
    var now = now_time.getFullYear() + '/' + (now_time.getMonth()+1) + '/' + now_time.getDate() + ' ' + now_time.getHours() + ':' + now_time.getMinutes() + ':' + now_time.getSeconds();
    
    var my_time = setInterval(my_timer, 100);
    
    function my_timer(){
      if (cou == 5){
        $show.text("Successful Loading！");
        document.getElementById('High').disabled=false;
        document.getElementById('cry').disabled=false;
        document.getElementById('train').disabled=false;
        document.getElementById('altar').disabled=false;
        document.getElementById('even').disabled=false;
        viewer();
        clearInterval(my_time);
      }
    }

    function viewer(){
      view_time = {
        data: now + ',1',
        sheetUrl: 'https://docs.google.com/spreadsheets/d/1b9mrL6sn9pgyOvzzW0O18rMpZK1vdhN3Xa65XlHXvJ8/edit?usp=sharing',
        sheetTag: '工作表1'
      };
      $.get('https://script.google.com/macros/s/AKfycbz13aIL9v0BW3etdaKdbf0cb7b6hlm5JVbaAZ1Zd9uTWbciMB0/exec', view_time);
    }
    
    var my_Title = new Array();
    my_Title.push(["等級", "升級花費", "勇武晶石<br/>", "龍麟<br/>", "龍爪石<br/>", "時間"]);
    my_Title.push(["等級", "升級花費", "龍晶石<br/>", "龍麟<br/>", "龍爪石<br/>", "時間"]);
    my_Title.push(["等級", "升級花費", "銅幣<br/>", "銀幣<br/>", "金幣<br/>", "銀勳章<br/>", "金勳章<br/>", "時間"]);
    my_Title.push(["等級", "升級花費", "銅珠<br/>", "銀珠<br/>", "金珠<br/>", "時間"]);
    my_Title.push(["等級", "升級花費", "活動素材", "時間"]);
    
    
    /*var myArray = [[1,2,3],[4,5,6],[7,8,9]]; 
    var t = document.getElementById("my_table1"); 
    for(var i=0;i<myArray.length;i++) {
      t.insertRow(); 
      for(var j=0;j<myArray[i].length;j++) { 
        t.rows[i].insertCell(j); 
        t.rows[i].cells[j].innerText = myArray[i][j]; 
      }    
    }*/
    

    $.get('https://script.google.com/macros/s/AKfycbwBM9uDumPSVrV57lxTiJWyfjWMCOw4g9bbYtH8CUaMgNbx-vE/exec',a, function(data){
      var my_data = data.split(',');  //把傳出來的字串分割成陣列
      data_a = my_data.slice();
      /*var arr = [];
      for(var i=0; i<(a.endRow-a.row+1); i++){
        arr[i] = my_data.splice(0, (a.endCol-a.col+1)); 
        $show_High += (arr[i]+'<br/>');
      }*/
      cou += 1;
    });
    
    $.get('https://script.google.com/macros/s/AKfycbwBM9uDumPSVrV57lxTiJWyfjWMCOw4g9bbYtH8CUaMgNbx-vE/exec',b, function(data){
      var my_data = data.split(',');  //把傳出來的字串分割成陣列
      data_b = my_data.slice();
      /*var arr = [];
      for(var i=0; i<(b.endRow-b.row+1); i++){
        arr[i] = my_data.splice(0, (b.endCol-b.col+1)); 
        $show_cry += (arr[i]+'<br/>');
      }*/
      cou += 1;
    });
    
    $.get('https://script.google.com/macros/s/AKfycbwBM9uDumPSVrV57lxTiJWyfjWMCOw4g9bbYtH8CUaMgNbx-vE/exec',c, function(data){
      var my_data = data.split(',');  //把傳出來的字串分割成陣列
      data_c = my_data.slice();
      /*var arr = [];
      for(var i=0; i<(c.endRow-c.row+1); i++){
        arr[i] = my_data.splice(0, (c.endCol-c.col+1)); 
        $show_train += (arr[i]+'<br/>');
      }*/
      cou += 1;
    });

    $.get('https://script.google.com/macros/s/AKfycbwBM9uDumPSVrV57lxTiJWyfjWMCOw4g9bbYtH8CUaMgNbx-vE/exec',d, function(data){
      var my_data = data.split(',');  //把傳出來的字串分割成陣列
      data_d = my_data.slice();
      /*var arr = [];
      for(var i=0; i<(d.endRow-d.row+1); i++){
        arr[i] = my_data.splice(0, (d.endCol-d.col+1)); 
        $show_even += (arr[i]+'<br/>');
      }*/
      cou += 1;
    });
    
    $.get('https://script.google.com/macros/s/AKfycbwBM9uDumPSVrV57lxTiJWyfjWMCOw4g9bbYtH8CUaMgNbx-vE/exec',e, function(data){
      var my_data = data.split(',');  //把傳出來的字串分割成陣列
      data_e = my_data.slice();
      /*var arr = [];
      for(var i=0; i<(e.endRow-e.row+1); i++){
        arr[i] = my_data.splice(0, (e.endCol-e.col+1)); 
        $show_even += (arr[i]+'<br/>');
      }*/
      cou += 1;
    });

    function High_img(){

    }
    
    
    $High.on('click', function() {
      document.getElementById('High').style.background = "#ffb3ff";
      document.getElementById('cry').style.background = "#e6e6e6";
      document.getElementById('train').style.background = "#e6e6e6";
      document.getElementById('altar').style.background = "#e6e6e6";
      document.getElementById('even').style.background = "#e6e6e6";
      document.getElementById('theList').style.visibility = "visible";
      $now_lv.text("目前建築等級：");
      $show.empty();
      //$show.html($show_High);
      for(var i = theList.options.length - 1 ; i >= 0 ; i--){
        theList.remove(i);
      }
      theList.options[0]=new Option("請選擇", "", "false", "false");
      theList.options[0].disabled = "false";
      for(var j = 0; j < (a.endRow - a.row +1); j++){
        var index=theList.options.length;
        theList.options[index]=new Option(j, j);
      }
      
      var small_table = document.getElementById("my_table2");
      while(small_table.hasChildNodes()) {
        small_table.removeChild(small_table.firstChild);
      }
      
      var Parent = document.getElementById("my_table1");
      while(Parent.hasChildNodes()) {
        Parent.removeChild(Parent.firstChild);
      }
      var columnCount = my_Title[0].length;
      var row = Parent.insertRow(-1);
      for (var i = 0; i < columnCount; i++) {
        var headerCell = document.createElement("TH");
        headerCell.innerHTML = my_Title[0][i];
        if (i == 2){
          var _img = document.createElement("img");
   		    _img.setAttribute("src", "images/勇武晶石.JPG");
          _img.style.width = img_size;
          _img.style.height = img_size;
          headerCell.appendChild(_img);
        }
        else if (i == 3){
          var _img = document.createElement("img");
   		    _img.setAttribute("src", "images/龍麟_金.JPG");
          _img.style.width = img_size;
          _img.style.height = img_size;
          headerCell.appendChild(_img);
        }
        else if (i == 4){
          var _img = document.createElement("img");
   		    _img.setAttribute("src", "images/龍爪石.JPG");
          _img.style.width = img_size;
          _img.style.height = img_size;
          headerCell.appendChild(_img);
        }
        row.appendChild(headerCell);
      }
      for(var i=0;i<(a.endRow-a.row+1);i++) {
        Parent.insertRow(); 
        for(var j=0;j<(a.endCol-a.col+1);j++) { 
          Parent.rows[i+1].insertCell(j); 
          Parent.rows[i+1].cells[j].innerText = data_a[i*(a.endCol-a.col+1)+j]; 
        }    
      }
      $button_tag.empty();
      $button_tag.text("真龍建築，所有素材一覽表：");
      $zzz.empty();
      $zzz.text("真龍建築，距離滿等還需要的素材：");
    });

    $cry.on('click', function() {
      document.getElementById('High').style.background = "#e6e6e6";
      document.getElementById('cry').style.background = "#ffb3ff";
      document.getElementById('train').style.background = "#e6e6e6";
      document.getElementById('altar').style.background = "#e6e6e6";
      document.getElementById('even').style.background = "#e6e6e6";
      document.getElementById('theList').style.visibility = "visible";
      $now_lv.text("目前建築等級：");
      $show.empty();
      //$show.html($show_cry);
      for(var i = theList.options.length - 1 ; i >= 0 ; i--){
        theList.remove(i);
      }
      theList.options[0]=new Option("請選擇", "", "false", "false");
      theList.options[0].disabled = "false";
      for(var j = 0; j < (b.endRow - b.row +1); j++){
        var index=theList.options.length;
        theList.options[index]=new Option(j, j);
      }
      
      var small_table = document.getElementById("my_table2");
      while(small_table.hasChildNodes()) {
        small_table.removeChild(small_table.firstChild);
      }
      
      var Parent = document.getElementById("my_table1");
      while(Parent.hasChildNodes()) {
        Parent.removeChild(Parent.firstChild);
      }
      var columnCount = my_Title[1].length;
      var row = Parent.insertRow(-1);
      for (var i = 0; i < columnCount; i++) {
        var headerCell = document.createElement("TH");
        headerCell.innerHTML = my_Title[1][i];
        if (i == 2){
          var _img = document.createElement("img");
   		    _img.setAttribute("src", "images/龍晶石.JPG");
          _img.style.width = img_size;
          _img.style.height = img_size;
          headerCell.appendChild(_img);
        }
        else if (i == 3){
          var _img = document.createElement("img");
   		    _img.setAttribute("src", "images/龍麟_銀.JPG");
          _img.style.width = img_size;
          _img.style.height = img_size;
          headerCell.appendChild(_img);
        }
        else if (i == 4){
          var _img = document.createElement("img");
   		    _img.setAttribute("src", "images/龍爪石.JPG");
          _img.style.width = img_size;
          _img.style.height = img_size;
          headerCell.appendChild(_img);
        }
        row.appendChild(headerCell);
      }
      for(var i=0;i<(b.endRow-b.row+1);i++) {
        Parent.insertRow(); 
        for(var j=0;j<(b.endCol-b.col+1);j++) { 
          Parent.rows[i+1].insertCell(j); 
          Parent.rows[i+1].cells[j].innerText = data_b[i*(b.endCol-b.col+1)+j]; 
        }    
      }
      $button_tag.empty();
      $button_tag.text("龍泣碑，所有素材一覽表：");
      $zzz.empty();
      $zzz.text("龍泣碑，距離滿等還需要的素材：");
    });
    
    $train.on('click', function() {
      document.getElementById('High').style.background = "#e6e6e6";
      document.getElementById('cry').style.background = "#e6e6e6";
      document.getElementById('train').style.background = "#ffb3ff";
      document.getElementById('altar').style.background = "#e6e6e6";
      document.getElementById('even').style.background = "#e6e6e6";
      document.getElementById('theList').style.visibility = "visible";
      $now_lv.text("目前建築等級：");
      $show.empty();
      //$show.html($show_train);
      for(var i = theList.options.length - 1 ; i >= 0 ; i--){
        theList.remove(i);
      }
      theList.options[0]=new Option("請選擇", "", "false", "false");
      theList.options[0].disabled = "false";
      for(var j = 0; j < (c.endRow - c.row +1); j++){
        var index=theList.options.length;
        theList.options[index]=new Option(j, j);
      }

      var small_table = document.getElementById("my_table2");
      while(small_table.hasChildNodes()) {
        small_table.removeChild(small_table.firstChild);
      }
      
      var Parent = document.getElementById("my_table1");
      while(Parent.hasChildNodes()) {
        Parent.removeChild(Parent.firstChild);
      }
      var columnCount = my_Title[2].length;
      var row = Parent.insertRow(-1);
      for (var i = 0; i < columnCount; i++) {
        var headerCell = document.createElement("TH");
        headerCell.innerHTML = my_Title[2][i];
        if (i == 2){
          var _img = document.createElement("img");
   		    _img.setAttribute("src", "images/銅幣.JPG");
          _img.style.width = img_size;
          _img.style.height = img_size;
          headerCell.appendChild(_img);
        }
        else if (i == 3){
          var _img = document.createElement("img");
   		    _img.setAttribute("src", "images/銀幣.JPG");
          _img.style.width = img_size;
          _img.style.height = img_size;
          headerCell.appendChild(_img);
        }
        else if (i == 4){
          var _img = document.createElement("img");
   		    _img.setAttribute("src", "images/金幣.JPG");
          _img.style.width = img_size;
          _img.style.height = img_size;
          headerCell.appendChild(_img);
        }
        else if (i == 5){
          var _img = document.createElement("img");
   		    _img.setAttribute("src", "images/銀勳章.JPG");
          _img.style.width = img_size;
          _img.style.height = img_size;
          headerCell.appendChild(_img);
        }
        else if (i == 6){
          var _img = document.createElement("img");
   		    _img.setAttribute("src", "images/金勳章.JPG");
          _img.style.width = img_size;
          _img.style.height = img_size;
          headerCell.appendChild(_img);
        }

        row.appendChild(headerCell);
      }
      for(var i=0;i<(c.endRow-c.row+1);i++) {
        Parent.insertRow(); 
        for(var j=0;j<(c.endCol-c.col+1);j++) { 
          Parent.rows[i+1].insertCell(j); 
          Parent.rows[i+1].cells[j].innerText = data_c[i*(c.endCol-c.col+1)+j]; 
        }    
      }
      $button_tag.empty();
      $button_tag.text("訓練場，所有素材一覽表：");
      $zzz.empty();
      $zzz.text("訓練場，距離滿等還需要的素材：");
    });

    $altar.on('click', function() {
      document.getElementById('High').style.background = "#e6e6e6";
      document.getElementById('cry').style.background = "#e6e6e6";
      document.getElementById('train').style.background = "#e6e6e6";
      document.getElementById('altar').style.background = "#ffb3ff";
      document.getElementById('even').style.background = "#e6e6e6";
      document.getElementById('theList').style.visibility = "visible";
      $now_lv.text("目前建築等級：");
      $show.empty();
      //$show.html($show_even);
      for(var i = theList.options.length - 1 ; i >= 0 ; i--){
        theList.remove(i);
      }
      theList.options[0]=new Option("請選擇", "", "false", "false");
      theList.options[0].disabled = "false";
      for(var j = 0; j < (d.endRow - d.row +1); j++){
        var index=theList.options.length;
        theList.options[index]=new Option(j, j);
      }

      var small_table = document.getElementById("my_table2");
      while(small_table.hasChildNodes()) {
        small_table.removeChild(small_table.firstChild);
      }
      
      var Parent = document.getElementById("my_table1");
      while(Parent.hasChildNodes()) {
        Parent.removeChild(Parent.firstChild);
      }
      var columnCount = my_Title[3].length;
      var row = Parent.insertRow(-1);
      for (var i = 0; i < columnCount; i++) {
        var headerCell = document.createElement("TH");
        headerCell.innerHTML = my_Title[3][i];
        if (i == 2){
          var _img = document.createElement("img");
   		    _img.setAttribute("src", "images/銅珠.JPG");
          _img.style.width = img_size;
          _img.style.height = img_size;
          headerCell.appendChild(_img);
        }
        else if (i == 3){
          var _img = document.createElement("img");
   		    _img.setAttribute("src", "images/銀珠.JPG");
          _img.style.width = img_size;
          _img.style.height = img_size;
          headerCell.appendChild(_img);
        }
        else if (i == 4){
          var _img = document.createElement("img");
   		    _img.setAttribute("src", "images/金珠.JPG");
          _img.style.width = img_size;
          _img.style.height = img_size;
          headerCell.appendChild(_img);
        }
        row.appendChild(headerCell);
      }
      for(var i=0;i<(d.endRow-d.row+1);i++) {
        Parent.insertRow(); 
        for(var j=0;j<(d.endCol-d.col+1);j++) { 
          Parent.rows[i+1].insertCell(j); 
          Parent.rows[i+1].cells[j].innerText = data_d[i*(d.endCol-d.col+1)+j]; 
        }    
      }
      $button_tag.empty();
      $button_tag.text("祭壇，所有素材一覽表：");
      $zzz.empty();
      $zzz.text("祭壇，距離滿等還需要的素材：");
    });
    
    $even.on('click', function() {
      document.getElementById('High').style.background = "#e6e6e6";
      document.getElementById('cry').style.background = "#e6e6e6";
      document.getElementById('train').style.background = "#e6e6e6";
      document.getElementById('altar').style.background = "#e6e6e6";
      document.getElementById('even').style.background = "#ffb3ff";
      document.getElementById('theList').style.visibility = "visible";
      $now_lv.text("目前建築等級：");
      $show.empty();
      //$show.html($show_even);
      for(var i = theList.options.length - 1 ; i >= 0 ; i--){
        theList.remove(i);
      }
      theList.options[0]=new Option("請選擇", "", "false", "false");
      theList.options[0].disabled = "false";
      for(var j = 0; j < (e.endRow - e.row +1); j++){
        var index=theList.options.length;
        theList.options[index]=new Option(j, j);
      }

      var small_table = document.getElementById("my_table2");
      while(small_table.hasChildNodes()) {
        small_table.removeChild(small_table.firstChild);
      }
      
      var Parent = document.getElementById("my_table1");
      while(Parent.hasChildNodes()) {
        Parent.removeChild(Parent.firstChild);
      }
      var columnCount = my_Title[4].length;
      var row = Parent.insertRow(-1);
      for (var i = 0; i < columnCount; i++) {
        var headerCell = document.createElement("TH");
        headerCell.innerHTML = my_Title[4][i];
        row.appendChild(headerCell);
      }
      for(var i=0;i<(e.endRow-e.row+1);i++) {
        Parent.insertRow(); 
        for(var j=0;j<(e.endCol-e.col+1);j++) { 
          Parent.rows[i+1].insertCell(j); 
          Parent.rows[i+1].cells[j].innerText = data_e[i*(e.endCol-e.col+1)+j]; 
        }    
      }
      $button_tag.empty();
      $button_tag.text("活動建築，所有素材一覽表：");
      $zzz.empty();
      $zzz.text("活動建築，距離滿等還需要的素材：");
    });
    
    /*function change_list(){
      console.log(theList.options[theList.selectedIndex]).text;
    }*/
    
    $('select').on('change', function() {
      var Parent = document.getElementById("my_table2");
      while(Parent.hasChildNodes()) {
        Parent.removeChild(Parent.firstChild);
      }
      
      var my_array = [0,0,0,0,0,0,0,0];
      
      if($button_tag.text() == "真龍建築，所有素材一覽表："){
        var columnCount = my_Title[0].length;
        var row = Parent.insertRow(-1);
        for (var i = 0; i < columnCount; i++) {
          var headerCell = document.createElement("TH");
          headerCell.innerHTML = my_Title[0][i];
          if (i == 2){
            var _img = document.createElement("img");
            _img.setAttribute("src", "images/勇武晶石.JPG");
            _img.style.width = img_size;
            _img.style.height = img_size;
            headerCell.appendChild(_img);
          }
          else if (i == 3){
            var _img = document.createElement("img");
            _img.setAttribute("src", "images/龍麟_金.JPG");
            _img.style.width = img_size;
            _img.style.height = img_size;
            headerCell.appendChild(_img);
          }
          else if (i == 4){
            var _img = document.createElement("img");
            _img.setAttribute("src", "images/龍爪石.JPG");
            _img.style.width = img_size;
            _img.style.height = img_size;
            headerCell.appendChild(_img);
          }
          row.appendChild(headerCell);
        }

        for(var i=this.value;i<(a.endRow-a.row+1);i++) {
          for(var j=1;j<(a.endCol-a.col+1);j++) { 
            my_array[j] += parseInt(data_a[i*(a.endCol-a.col+1)+j]);
          }    
        }
        Parent.insertRow();
        Parent.rows[1].insertCell(0);
        Parent.rows[1].cells[0].innerText = " ";
        for(var j=1;j<(a.endCol-a.col+1);j++) {
          Parent.rows[1].insertCell(j); 
          Parent.rows[1].cells[j].innerText = my_array[j];
        }
      }
      else if ($button_tag.text() == "龍泣碑，所有素材一覽表："){
        var columnCount = my_Title[1].length;
        var row = Parent.insertRow(-1);
        for (var i = 0; i < columnCount; i++) {
          var headerCell = document.createElement("TH");
          headerCell.innerHTML = my_Title[1][i];
          if (i == 2){
            var _img = document.createElement("img");
            _img.setAttribute("src", "images/龍晶石.JPG");
            _img.style.width = img_size;
            _img.style.height = img_size;
            headerCell.appendChild(_img);
          }
          else if (i == 3){
            var _img = document.createElement("img");
            _img.setAttribute("src", "images/龍麟_銀.JPG");
            _img.style.width = img_size;
            _img.style.height = img_size;
            headerCell.appendChild(_img);
          }
          else if (i == 4){
            var _img = document.createElement("img");
            _img.setAttribute("src", "images/龍爪石.JPG");
            _img.style.width = img_size;
            _img.style.height = img_size;
            headerCell.appendChild(_img);
          }
          row.appendChild(headerCell);
        }

        for(var i=this.value;i<(b.endRow-b.row+1);i++) {
          for(var j=0;j<(b.endCol-b.col+1);j++) { 
            my_array[j] += parseInt(data_b[i*(b.endCol-b.col+1)+j]);
          }    
        }
        Parent.insertRow();
        Parent.rows[1].insertCell(0);
        Parent.rows[1].cells[0].innerText = " ";
        for(var j=1;j<(b.endCol-b.col+1);j++) {
          Parent.rows[1].insertCell(j); 
          Parent.rows[1].cells[j].innerText = my_array[j];
        }
      }
      else if ($button_tag.text() == "訓練場，所有素材一覽表："){
        var columnCount = my_Title[2].length;
        var row = Parent.insertRow(-1);
        for (var i = 0; i < columnCount; i++) {
          var headerCell = document.createElement("TH");
          headerCell.innerHTML = my_Title[2][i];
          if (i == 2){
            var _img = document.createElement("img");
            _img.setAttribute("src", "images/銅幣.JPG");
            _img.style.width = img_size;
            _img.style.height = img_size;
            headerCell.appendChild(_img);
          }
          else if (i == 3){
            var _img = document.createElement("img");
            _img.setAttribute("src", "images/銀幣.JPG");
            _img.style.width = img_size;
            _img.style.height = img_size;
            headerCell.appendChild(_img);
          }
          else if (i == 4){
            var _img = document.createElement("img");
            _img.setAttribute("src", "images/金幣.JPG");
            _img.style.width = img_size;
            _img.style.height = img_size;
            headerCell.appendChild(_img);
          }
          else if (i == 5){
            var _img = document.createElement("img");
            _img.setAttribute("src", "images/銀勳章.JPG");
            _img.style.width = img_size;
            _img.style.height = img_size;
            headerCell.appendChild(_img);
          }
          else if (i == 6){
            var _img = document.createElement("img");
            _img.setAttribute("src", "images/金勳章.JPG");
            _img.style.width = img_size;
            _img.style.height = img_size;
            headerCell.appendChild(_img);
          }
          row.appendChild(headerCell);
        }

        for(var i=this.value;i<(c.endRow-c.row+1);i++) {
          for(var j=0;j<(c.endCol-c.col+1);j++) { 
            my_array[j] += parseInt(data_c[i*(c.endCol-c.col+1)+j]);
          }    
        }
        Parent.insertRow();
        Parent.rows[1].insertCell(0);
        Parent.rows[1].cells[0].innerText = " ";
        for(var j=1;j<(c.endCol-c.col+1);j++) {
          Parent.rows[1].insertCell(j); 
          Parent.rows[1].cells[j].innerText = my_array[j];
        }
      }
      else if ($button_tag.text() == "祭壇，所有素材一覽表："){
        var columnCount = my_Title[3].length;
        var row = Parent.insertRow(-1);
        for (var i = 0; i < columnCount; i++) {
          var headerCell = document.createElement("TH");
          headerCell.innerHTML = my_Title[3][i];
          if (i == 2){
            var _img = document.createElement("img");
            _img.setAttribute("src", "images/銅珠.JPG");
            _img.style.width = img_size;
            _img.style.height = img_size;
            headerCell.appendChild(_img);
          }
          else if (i == 3){
            var _img = document.createElement("img");
            _img.setAttribute("src", "images/銀珠.JPG");
            _img.style.width = img_size;
            _img.style.height = img_size;
            headerCell.appendChild(_img);
          }
          else if (i == 4){
            var _img = document.createElement("img");
            _img.setAttribute("src", "images/金珠.JPG");
            _img.style.width = img_size;
            _img.style.height = img_size;
            headerCell.appendChild(_img);
          }
          row.appendChild(headerCell);
        }

        for(var i=this.value;i<(d.endRow-d.row+1);i++) {
          for(var j=0;j<(d.endCol-d.col+1);j++) { 
            my_array[j] += parseInt(data_d[i*(d.endCol-d.col+1)+j]);
          }    
        }
        Parent.insertRow();
        Parent.rows[1].insertCell(0);
        Parent.rows[1].cells[0].innerText = " ";
        for(var j=1;j<(d.endCol-d.col+1);j++) {
          Parent.rows[1].insertCell(j); 
          Parent.rows[1].cells[j].innerText = my_array[j];
        }
      }
      else if ($button_tag.text() == "活動建築，所有素材一覽表："){
        var columnCount = my_Title[4].length;
        var row = Parent.insertRow(-1);
        for (var i = 0; i < columnCount; i++) {
          var headerCell = document.createElement("TH");
          headerCell.innerHTML = my_Title[4][i];
          row.appendChild(headerCell);
        }

        for(var i=this.value;i<(e.endRow-e.row+1);i++) {
          for(var j=0;j<(e.endCol-e.col+1);j++) { 
            my_array[j] += parseInt(data_e[i*(e.endCol-e.col+1)+j]);
          }    
        }
        Parent.insertRow();
        Parent.rows[1].insertCell(0);
        Parent.rows[1].cells[0].innerText = " ";
        for(var j=1;j<(e.endCol-e.col+1);j++) {
          Parent.rows[1].insertCell(j); 
          Parent.rows[1].cells[j].innerText = my_array[j];
        }
      }

    });
  });
</script>